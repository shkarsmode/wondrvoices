<div class="browse-requests">
    <section class="hero">
        <h1>Journeys Seeking Support</h1>
        <p class="subtitle">
            These are real people facing cancer, rare diseases, and life-threatening illness.<br>
            Each journey is waiting for your words of encouragement.
        </p>
    </section>

    <section class="filters">
        <div class="pill-row" role="list">
            <button
                *ngFor="let filter of filters"
                type="button"
                class="pill"
                [class.active]="selectedFilter() === filter.id"
                (click)="setFilter(filter.id)">
                <span class="material-symbols-outlined icon">{{ filter.icon }}</span>
                <span>{{ filter.label }}</span>
            </button>
        </div>

        <div class="control-row">
            <div class="dropdown" [class.open]="zoneDropdownOpen">
                <button type="button" class="dropdown-toggle" (click)="toggleZoneDropdown()">
                    <span class="material-symbols-outlined">auto_awesome</span>
                    <span>{{ getSelectedZoneLabel() }}</span>
                    <span class="material-symbols-outlined caret">expand_more</span>
                </button>
                <div class="dropdown-menu" *ngIf="zoneDropdownOpen">
                    <button 
                        *ngFor="let zone of comfortZones" 
                        type="button" 
                        class="dropdown-item"
                        [class.selected]="selectedZone() === zone.id"
                        (click)="selectZone(zone.id)">
                        <span class="material-symbols-outlined">{{ zone.icon }}</span>
                        <span>{{ zone.label }}</span>
                        <span class="material-symbols-outlined check" *ngIf="selectedZone() === zone.id">check</span>
                    </button>
                </div>
            </div>

            <div class="dropdown" [class.open]="sortDropdownOpen">
                <button type="button" class="dropdown-toggle" (click)="toggleSortDropdown()">
                    <span class="material-symbols-outlined">swap_vert</span>
                    <span>{{ getSelectedSortLabel() }}</span>
                    <span class="material-symbols-outlined caret">expand_more</span>
                </button>
                <div class="dropdown-menu" *ngIf="sortDropdownOpen">
                    <button 
                        *ngFor="let option of sortOptions" 
                        type="button" 
                        class="dropdown-item"
                        [class.selected]="selectedSort() === option.id"
                        (click)="selectSort(option.id)">
                        <span>{{ option.label }}</span>
                        <span class="material-symbols-outlined check" *ngIf="selectedSort() === option.id">check</span>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <section class="content">
        <div class="requests-grid" *ngIf="viewMode() === 'grid'">
            <a class="request-card send-anyone" routerLink="/request-support">
                <div class="card-body">
                    <div class="icon-wrap">
                        <span class="material-symbols-outlined">favorite</span>
                    </div>
                    <h3>Send to Anyone</h3>
                    <p>Not sure who to support? Send a message to someone who needs it.</p>
                    <span class="pill-open">
                        <span class="material-symbols-outlined">autorenew</span>
                        Always Open
                    </span>
                </div>
            </a>

            <a class="request-card" *ngFor="let request of sortedRequests()" [routerLink]="['/request', request.id]">
                <div class="card-header">
                    <div class="avatar">{{ getDisplayName(request).charAt(0) }}</div>
                    <div class="identity">
                        <div class="name-row">
                            <span class="name">{{ getDisplayName(request) }}</span>
                            <span class="age" *ngIf="request.age">{{ request.age }}</span>
                        </div>
                        <div class="location">
                            <span class="material-symbols-outlined">location_on</span>
                            {{ request.location }}
                        </div>
                    </div>
                </div>

                <div class="diagnosis-badge" *ngIf="request.diagnosis">
                    <span class="material-symbols-outlined">{{ getDiagnosisIcon(request.diagnosis) }}</span>
                    {{ request.diagnosis }}
                </div>

                <p class="message">{{ request.additionalNote }}</p>

                <div class="stats">
                    <span class="stat hearts">
                        <span class="material-symbols-outlined">favorite</span>
                        {{ getHeartCount(request) }}
                    </span>
                    <span class="stat messages">
                        <span class="material-symbols-outlined">mail</span>
                        {{ request.comments || 0 }}
                    </span>
                    <span class="stat time">
                        <span class="material-symbols-outlined">schedule</span>
                        {{ getTimeAgo(request.createdAt) }}
                    </span>
                </div>
            </a>
        </div>

        <div class="empty" *ngIf="sortedRequests().length === 0">
            <p>No journeys match this filter.</p>
            <button type="button" (click)="setFilter(FilterCategory.All)">Show all</button>
        </div>
    </section>

    <section class="cta">
        <h2>Going Through Something?</h2>
        <p>You don't have to face it alone. Share your story and receive support from people who care.</p>
        <button routerLink="/request-support" type="button">Share Your Story</button>
    </section>
</div>
