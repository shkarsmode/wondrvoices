<div class="browse-requests">
    <section class="hero">
        <p class="eyebrow">Browse Journeys</p>
        <h1>Journeys Seeking Support</h1>
        <p class="subtitle">
            These are real people facing cancer, rare diseases, and life-threatening illness.
            Each journey is waiting for your words of encouragement.
        </p>
    </section>

    <section class="filters">
        <div class="pill-row" role="list">
            <button
                *ngFor="let filter of filters"
                type="button"
                class="pill"
                [class.active]="selectedFilter() === filter.id"
                (click)="setFilter(filter.id)">
                <span class="material-symbols-outlined icon">{{ filter.icon }}</span>
                <span>{{ filter.label }}</span>
            </button>
        </div>

        <div class="control-row">
            <label class="control">
                <span class="label">
                    <span class="material-symbols-outlined">favorite</span>
                    <!-- Comfort Zone -->
                </span>
                <select [value]="selectedFilter()" (change)="setFilter($any($event.target).value)">
                    <option *ngFor="let filter of filters" [value]="filter.id">{{ filter.label === 'All' ? 'All Zones' : filter.label }}</option>
                </select>
            </label>

            <label class="control">
                <span class="label">
                    <span class="material-symbols-outlined">arrow_upward</span>
                    Sort
                </span>
                <select [value]="selectedSort()" (change)="setSort($any($event.target).value)">
                    <option *ngFor="let option of sortOptions" [value]="option.id">{{ option.label }}</option>
                </select>
            </label>
        </div>
    </section>

    <section class="content">
        <div class="requests-grid" *ngIf="viewMode() === 'grid'">
            <a class="request-card send-anyone" routerLink="/request-support">
                <div class="card-body">
                    <div class="icon-wrap">
                        <span class="material-symbols-outlined">favorite</span>
                    </div>
                    <h3>Send to Anyone</h3>
                    <p>Not sure who to support? Send a message to someone who needs it.</p>
                    <span class="pill-muted">
                        <span class="material-symbols-outlined">star</span>
                        Always Open
                    </span>
                </div>
            </a>

            <a class="request-card" *ngFor="let request of sortedRequests()" [routerLink]="['/request', request.id]">
                <button class="favorite-btn" type="button" (click)="toggleFavorite($event, request)" [class.liked]="isLiked(request.id)">
                    <span class="material-symbols-outlined" [class.filled]="isLiked(request.id)">
                        {{ isLiked(request.id) ? 'favorite' : 'favorite_border' }}
                    </span>
                </button>

                <div class="card-header">
                    <div class="avatar">{{ getDisplayName(request).charAt(0) }}</div>
                    <div class="identity">
                        <div class="name-row">
                            <span class="name">{{ getDisplayName(request) }}</span>
                            <span class="age" *ngIf="request.age">{{ request.age }}</span>
                        </div>
                        <div class="location">
                            <span class="material-symbols-outlined">location_on</span>
                            {{ request.location }}
                        </div>
                        <div class="badge" *ngIf="request.diagnosis">{{ request.diagnosis }}</div>
                    </div>
                </div>

                <p class="message">{{ request.additionalNote }}</p>

                <div class="comfort-tags">
                    <span class="tag" *ngFor="let zone of request.comfortZones">
                        <span class="material-symbols-outlined">{{ getComfortZoneIcon(zone) }}</span>
                        {{ getComfortZoneLabel(zone) }}
                    </span>
                </div>

                <div class="stats">
                    <span class="stat" [class.liked]="isLiked(request.id)">
                        <span class="material-symbols-outlined">favorite</span>
                        {{ getHeartCount(request) }}
                    </span>
                    <span class="stat">
                        <span class="material-symbols-outlined">chat_bubble</span>
                        {{ request.comments || 0 }}
                    </span>
                    <span class="stat">
                        <span class="material-symbols-outlined">schedule</span>
                        {{ getTimeAgo(request.createdAt) }}
                    </span>
                </div>
            </a>
        </div>

        <div class="empty" *ngIf="sortedRequests().length === 0">
            <p>No journeys match this filter.</p>
            <button type="button" (click)="setFilter(FilterCategory.All)">Show all</button>
        </div>
    </section>

    <section class="cta">
        <h2>Going Through Something?</h2>
        <p>You don't have to face it alone. Share your story and receive support from people who care.</p>
        <button routerLink="/request-support" type="button">Share Your Story</button>
    </section>
</div>
